<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>Google Maps API サンプル</title>
    <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0; }
      #map { height: 100%; }
    </style>
  </head>
  <body>
    <div id="map"></div>

    <script type="text/javascript">
      var geocoder;
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'));

        var directionsRenderer = new google.maps.DirectionsRenderer;
        var directionsService = new google.maps.DirectionsService;
        directionsRenderer.setMap(map);
        /* ルートを予測 */
        var start = "東京工芸大学 厚木キャンパス";
        var end = "東京工芸大学 中野キャンパス";
        var request = {
            origin: start,
            destination: end,
            travelMode: google.maps.TravelMode.DRIVING,
            drivingOptions: {
                departureTime: new Date(),
                trafficModel: google.maps.TrafficModel.BEST_GUESS
            },
        };
        directionsService.route(request, function(response, status) {
          if (status == google.maps.DirectionsStatus.OK) {
            directionsRenderer.setDirections(response);//ルートの表示

            var service = new google.maps.places.PlacesService(map);
            
            for(waypoint in response.geocoded_waypoints){
              var request = {
                  placeId: waypoint.place_id
              };
              service.getDetails({placeId: waypoint.place_id}, function (place, status) {
                if (status == google.maps.places.PlacesServiceStatus.OK) {
                  var infowindow = new google.maps.InfoWindow({
                    map: map,
                    content : place.name,
                    location : place.location
                  });
                }
              });
            }
          }
        });
      }
    </script>

    <script async defer
      src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyDW04tuV_Gj08yffRb3md719cO7wi97Xx8&callback=initMap">
    </script>
  </body>
</html>
